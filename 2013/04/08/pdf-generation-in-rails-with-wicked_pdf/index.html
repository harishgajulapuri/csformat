
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>PDF generation in Rails - Codingarena</title>
  <meta name="author" content="Manu S Ajith">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
    
  
  <meta name="description" content="Recently my friend was working on a project that had a requirement to export the html page to PDF. He had some issues setting this up. So I thought &hellip;">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://manusajith.github.io/blog/2013/04/08/pdf-generation-in-rails-with-wicked_pdf/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Codingarena" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="Codingarena" />
  <meta name="og:title" content="PDF generation in Rails" />
  <meta name="og:description" content="Recently my friend was working on a project that had a requirement to export the html page to PDF. He had some issues setting this up. So I thought &hellip;" />
  <meta name="og:url" content="http://manusajith.github.io/blog/2013/04/08/pdf-generation-in-rails-with-wicked_pdf/"/>
  <meta name="url" content="http://manusajith.github.io/blog/2013/04/08/pdf-generation-in-rails-with-wicked_pdf/">
  
  <meta name="subject" content=""/>
  <meta name="category" content=""/>
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30559513-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><div class="navbar">
  <div class="navbar-inner">
    <a class="brand" href="/">Codingarena</a>
    <ul class="nav">
      <li><a href="/">Home</a></li>
      <li><a href="/blog/archives">Archives</a></li>
    </ul>
    <ul class="nav" data-subscription="rss">
      <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      
    </ul>
      
    <form class="navbar-form" action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:manusajith.github.io" />
        <input class="span2" type="text" name="q" results="0" placeholder="Search"/>
      </fieldset>
    </form>
      
    
  </div>
</div>
</nav>
  <div class="wrapper_single">
    <div class="container-fluid">
      <div class="row-fluid">
        <article class="span8 offset1" role="article">
          <div class="article-format">

  <header>
    
      <h1 class="entry-title">PDF Generation in Rails</h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/110007023591027468321?rel=author"><span class="fn">Manu S Ajith</span></a></span>
  

 - 
        








  


<time datetime="2013-04-08T00:00:00+05:30" pubdate data-updated="true">Apr 8<span>th</span>, 2013</time> - 
        


        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Recently my friend was working on a project that had a requirement to export the html page to PDF. He had some issues setting this up. So I thought I would write this article, so that it will be helpful for  anyone who faces the same issue. It’s easy getting your pdf in rails as long as you follow the right steps ;) (But unfortunately my good friend doesnt always do that for some reason of his own &ndash; No offense intended ;) )</p>

<p>If you are using Rails, then you have this wonderful <a href="http://rubygems.org">rubygems</a> where you can find a no of gems for pdf generation. The suggested ones are <a href="http://rubygems.org/gems/prawn">prawn</a> and <a href="http://rubygems.org/gems/wicked_pdf">wicked_pdf</a>.</p>

<h2>Which one to chose ?</h2>

<p>For me wicked_pdf is very simple to understand and it gets your job done very quickly if you follow all the right steps, while Prawn restricts you to the old table, grids layout. But ultimately its you who will have to decide which to use depending upon your specific requirements.</p>

<p>I will be using wicked_pdf and ubuntu.</p>

<h2>Wicked_pdf</h2>

<p>Wicked_pdf uses a shell utility <a href="http://code.google.com/p/wkhtmltopdf/">Wkhtmltopdf</a>  to serve a PDF file to a user from a HTML page. In other words, rather than dealing with a PDF generation DSL of some sort, you simply write an HTML view as you would normally, then let Wicked take care of the hard stuff</p>

<h2>Now what is wkhtmltopdf ?</h2>

<p><a href="http://code.google.com/p/wkhtmltopdf" >Wkhtmltopdf</a> is an c++ executable that <a href="https://github.com/mileszs/wicked_pdf" >wicked_pdf</a><span > gem essentialy wraps. It works great for pdf generation of tables reports etc. The WK in wkhtmltopdf stands for webkit which is the browser engine that is used to render HTML and java-script  Chrome uses this same engine.</p>

<p>Installing it simply via</p>

<pre><code>sudo apt-get install wkhtmltopdf
</code></pre>

<p>on Ubuntu will install a reduced functionality version which is probably not what you want. According to the manual the reduced functionality version does not include the following features.
Printing more then one HTML document into a PDF file. </p>

<p>Running without an X11 server. 
Adding a document outline to the PDF file. 
Adding headers and footers to the PDF file.
Generating a table of contents. 
Adding links in the generated PDF file. 
Printing using the screen media-type. 
Disabling the smart shrink feature of webkit. 
If you need any of these, then you need to setup the static version of wkhtmltopdf.
First check OS is 32 bit or 64 bit by using following command
Try</p>

<pre><code>    uname -m
</code></pre>

<p>Run following command for installing dependencies.</p>

<pre><code>    sudo apt-get install openssl build-essential xorg libssl-dev libxrender-dev
</code></pre>

<p>Based on OS download wkhtmltopdf package from following site
<a href=" http://code.google.com/p/wkhtmltopdf/downloads/list"><a href="http://code.google.com/p/wkhtmltopdf/downloads/list">http://code.google.com/p/wkhtmltopdf/downloads/list</a></a></p>

<p>Then extract using command</p>

<pre><code>    tar xvjf wkhtmltopdf-0.11.0_rc1-static-amd64.tar.bz2
</code></pre>

<p>Then move extracted DIR to usr/local/bin folder</p>

<pre><code>    sudo mv wkhtmltopdf-0.11.0_rc1-static-amd64 /usr/local/bin/wkhtmltopdf
</code></pre>

<p>Check wkhtmltopdf is installed or not using following command</p>

<pre><code>    which wkhtmltopdf
</code></pre>

<h2>Using wicked_pdf in your Rails app</h2>

<p>Add this to your Gemfile</p>

<pre><code>    gem 'wicked_pdf'
</code></pre>

<p>You may also need to add the following to your config/initializers/mime_types.rb</p></p>

<pre><code>    Mime::Type.register "application/pdf", :pdf
</code></pre>

<h2>Basic Usage:</h2>

<pre><code>class Invoice &lt; ApplicationController
  def show
    respond_to do |format|
      format.html
      format.pdf do
        render :pdf =&gt; "invoice"
      end
    end
  end
end
</code></pre>

<p>If you need to include stylesheets and javascript inside the generated document, the wicked_pdf gem has helpers for that</p>

<pre><code>    &lt;%= wicked_pdf_stylesheet_link_tag "pdf_stylesheet" -%&gt;
    &lt;%= wicked_pdf_javascript_include_tag "pdf_javascript" %&gt;
</code></pre>

<h2>Some tweaks and tips</h2>

<p>If you need to hide some links in your generated PDF document then you can use a custom stylesheet which defines the properties for print media and can include the same using the above helper method.</p>

<p>Eg: You have a button on your html page and you dont want that to be displayed when you generate the PDF.</p>

<p>If you have the following link with css selector &ldquo;print_friendly&rdquo;</p>

<pre><code>    &lt;%= link_to "Print" , "http://example.com/download", :id=&gt;"print_friendly" %&gt;
</code></pre>

<p>and have a stylesheet with the css properties for print media as</p>

<pre><code>    @media print {
      #print_friendly{
      display:hidden;
      }
    }
</code></pre>

<p>then the link wont be visible inside the generated PDF document</p>

<p>If your page has a lot of javascript and needs longer time for rendering then you can add the following the wicked_pdf</p>

<pre><code>    wkhtmltopdf.exe --javascript-delay 15000 http://example.com/downloads
</code></pre>

<h2>Some common Issues</h2>

<h3>1. Runtime Error</h3>

<p>RuntimeError in XxxxController#show</p>

<p>Failed to execute: /usr/bin/wkhtmltopdf &mdash;print-media-type -q &ndash; &ndash; Error: PDF could not be generated!</p>

<pre><code>Rails.root: /apps/rails/show
</code></pre>

<p>Check the location of your wkhtmltopdf using which wkhtmltopdf and also run a bundle update command as sometimes your gem in gemfile would be configured with the wrong path.</p>

<h3>2. Is wkhtmltopdf-binary necessary to generated PDF files ?</h3>

<p>No</p>

<p>If you have installed the system libraries and have configured the path correctly in your app correctly, you dont need to install he wkhtmltopdf-binary gem seperately.</p>

<h3>3. Wicked_pdf not rendering graphs with HighCharts</h3>

<p>Wkhtmltopdf doesn&rsquo;t handle transparency/shadows properly and can result in unpredictable results. So the workaround is to add the following options to yo2ur highcharts</p>

<pre><code>        f.options[:plotOptions][:line] = :animation =&gt; false, :shadow =&gt; false, :enableMouseTracking =&gt; false
</code></pre>

<h4>As I said earlier it’s easy getting your pdf in rails as long as you follow the right steps ;)</h4>

<p>[Reposting my <a href="http://rubykitchen.in/blog/2013/03/17/pdf-generation-with-rails" title="Article" target="_blank">article</a> from <a href="http://rubykitchen.in" title="Ruby Kitchen " target="_blank">Ruby Kitchen</a> <a href="http://rubykitchen.in/blog" title="Blog" target="_blank">Blog</a><br /></p>

<p><a href="http://facebook.com/manusajith">Manu</a></p>

<p><a href="http://www.codingarena.in">www.codingarena.in</a></p>

<p><a href="http://twitter.com/manusajith" title="Twitter">@manusajith</a> | <a href="http://github.com/manusajith" title="Github">@github</a></p>
</div>


  <footer>
    <p class="meta">
      
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/110007023591027468321?rel=author"><span class="fn">Manu S Ajith</span></a></span>
  


      








  


<time datetime="2013-04-08T00:00:00+05:30" pubdate data-updated="true">Apr 8<span>th</span>, 2013</time>
      


    </p>
    
      <div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

    
    
      <a class="pull-left" href="/blog/2012/11/22/google-code-jam/" title="Previous Post: Google Code Jam">&laquo; Google Code Jam</a>
    
    
  </footer>

</div>

          
        </article>
        <article class="span3 article-format" role="article">
          <div class="coderwall-endorse"><a href="https://coderwall.com/manusajith"><img alt="Endorse Manu S Ajith on Coderwall" src="http://api.coderwall.com/manusajith/endorsecount.png"></a></div>
          <embed type='application/x-shockwave-flash' src='/javascripts/tagcloud.swf'width='100%' height='250' bgcolor='#ffffff' id='tagcloudflash' name='tagcloudflash' quality='high' allowscriptaccess='always'flashvars="tcolor=0x333333&amp;tcolor2=0x333333&amp;hicolor=0x000000&amp;tspeed=100&amp;distr=true&amp;mode=tags&amp;tagcloud=%3Ctags%3E%3C%2Ftags%3E">
        </article>
      </div>
      </div>
    </div>
  </div>
  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">
      
        <li>
          <a href="/blog/2013/04/08/pdf-generation-in-rails-with-wicked_pdf/">PDF generation in Rails</a>
        </li>
      
        <li>
          <a href="/blog/2012/11/22/google-code-jam/">Google Code Jam</a>
        </li>
      
        <li>
          <a href="/blog/2012/10/30/154-server-monotoring-script/">Simple Server monitoring Shell Script</a>
        </li>
      
        <li>
          <a href="/blog/2012/09/12/reset-root-password-in-xampp/">Reset root password in XAMPP</a>
        </li>
      
        <li>
          <a href="/blog/2012/09/01/ubuntu-bonding-and-link-aggregation/">Ubuntu Bonding and link aggregation</a>
        </li>
      
    </ul>
    <h2><a href="/blog/archives">archives</a></h2>
  </div>
  <div class="span3">
    

  </div>
  <div class="span4">
    
<h2>twitter</h2>
<a href="https://twitter.com/manusajith" class="twitter-follow-button" data-show-count="true" data-lang="en">Follow @manusajith</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<div class="tweet" data-twitter-user="manusajith">
</div>


  </div>
  <div class="span2">
    <h2>found on</h2>

<a href="https://github.com/manusajith/" rel="tooltip" title="Github"><img class="social_icon" title="Github" alt="github icon" src="/images/glyphicons_381_github.png"></a>





<a href="http://www.linkedin.com/in/manusajith" rel="tooltip" title="Linkedin"><img class="social_icon" title="Linkedin" alt="Linkedin icon" src="/images/glyphicons_377_linked_in.png"></a>



<a href="http://twitter.com/manusajith" rel="tooltip" title="Twitter"><img class="social_icon" title="Twitter" alt="Twitter icon" src="/images/glyphicons_391_twitter_t.png"></a>



<a href="https://plus.google.com/110007023591027468321?rel=author" rel="tooltip" title="Google Plus"><img class="social_icon" title="Google Plus" alt="Google Plus icon" src="/images/glyphicons_386_google_plus.png"></a>





<h2>contact at</h2>
<a href="mailto:neo@codingarena.in">neo@codingarena.in</a>


  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  <a href="/">Codingarena</a>
  - Copyright &copy; 2013 - Manu S Ajith
</p>
<p class="pull-right">
  <span>Powered by <a href="http://octopress.org/">Octopress</a>.</span>
</p>

  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>


<script type="text/javascript">
      var disqus_shortname = 'codingarenablog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
